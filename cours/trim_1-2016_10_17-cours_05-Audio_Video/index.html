<!doctype html>
<html lang="fr">
	<head>
        <meta charset="utf-8">
        <title>TRIM 1 - Cours 05 - Audio Video</title>
        <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
        <meta name="author" content="Bruno Simon">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link rel="stylesheet" href="../src/reveal.js/css/reveal.css">
        <link rel="stylesheet" href="../src/reveal.js/css/theme/orange.css" id="theme">
        <link rel="stylesheet" href="../src/reveal.js/lib/css/highlight/railscasts.css">
        <!-- <link rel="stylesheet" href="../src/reveal.js/lib/css/highlight/github.css"> -->
        <link rel="stylesheet" href="../src/custom/style.css">
        <script>
            document.write( '<link rel="stylesheet" href="../src/reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
        </script>
        <!--[if lt IE 9]>
            <script src="../src/reveal.js/lib/js/html5shiv.js"></script>
        <![endif]-->
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
                <section>
                    <h3>H2 - P2020</h3>
                    <h1>Développement web</h1>
                    <h3>Cours 05 - 2016-10-17</h3>
                    <ul>
                        <li>github : <a target="_blank" href="https://github.com/brunosimon/hetic-p2020">https://github.com/brunosimon/hetic-p2020</a></li>
                        <li>site : <a target="_blank" href="http://bruno-simon.com/hetic/p2020/">http://bruno-simon.com/hetic/p2020/</a></li>
                        <li>contact : <a target="_blank" mailto="bruno.simon@hetic.net">bruno.simon@hetic.net</a></li>
                    </ul>
                </section>

				<section>
					<h3>HTML5</h3>
					<h1>Audio / Video</h1>
				</section>

                <section>
                    <p><span class="hl">APIs HTML5</span> permettant de lire des fichiers audio et vidéo directement dans la page à travers des balises <span class="hl">&lt;audio&gt;</span> et <span class="hl">&lt;video&gt;</span> sans utiliser Flash</p>
                </section>

                <!-- AUDIO -->
                <section>
                    <h2>Audio</h2>
                </section>

                <section>
                    <h2>Exemples</h2>
                    <pre><code data-trim contenteditable class="html">
&lt;audio src="audio.mp3"&gt;&lt;/audio&gt;
                    </code></pre>
                </section>

                <section>
                    <p>Message de fallback pour les visiteurs dont le navigateur ne supporte pas l'audio</p>
                    <pre><code data-trim contenteditable class="html">
&lt;audio src="audio.mp3"&gt;
    Your browser doesn't support video API
&lt;/audio&gt;
                    </code></pre>
                </section>

                <section>
                    <h2>Attributs</h2>
                    <ul>
                        <li><span class="hl">src</span> Fichier source</li>
                        <li><span class="hl">autoplay</span> Lance la lecture dès que le fichier suffisamment chargé</li>
                        <li><span class="hl">loop</span> Recommence la lecture à la fin</li>
                        <li><span class="hl">preload</span> Choix du buffering (none / auto / metadata)</li>
                        <li><span class="hl">controls</span> Affiche un controlleur (propre au navigateur)</li>
                        <li><span class="hl">muted</span> Couper le son</li>
                    </ul>
                </section>

                <section>
                    <p>Il est inutile d'indiquer une valeurs aux attributs qui n'en nécessitent pas</p>
                    <pre><code data-trim contenteditable class="html">
&lt;audio 
    src="audio.mp3"
    autoplay
    loop
    controls
    muted
&gt;&lt;/audio&gt;
                    </code></pre>
                </section>

                <section>
                    <h2>Controllers</h2>
                    <ul>
                        <li>Chrome<br><img src="src/img/audio-controls-chrome.png" alt="Controls Chrome"></li>
                        <li>Firefox<br><img src="src/img/audio-controls-firefox.png" alt="Controls Firefox"></li>
                        <li>Safari<br><img src="src/img/audio-controls-safari.png" alt="Controls Safari"></li>
                    </ul>
                </section>

                <section>
                    <h2>Formats</h2>
                    <p>Il est possible d'envoyer plusieurs formats et de laisser le navigateur choisir celui qu'il préfère</p>
                    <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Supported_media_formats#Browser_compatibility" target="_blank">Support des formats</a></p>
                    <pre><code data-trim contenteditable class="html">
&lt;audio autoplay="autoplay" loop="loop" controls="controls"&gt;
    <source src="audio.mp3" type="audio/mp3" />
    <source src="audio.ogg" type="audio/ogg" />
    Your browser doesn't support audio API
&lt;/audio&gt;
                    </code></pre>
                </section>

                <section>
                    <h2>Compatibilité</h2>
                    <p>Can I Use : <a target="_blank" href="http://caniuse.com/#feat=audio">http://caniuse.com/#feat=audio</a></p>
                </section>

                <!-- VIDEO -->
                <section>
                    <h2>Video</h2>
                    <p class="fragment">Comme l'API audio mais on remplace par <span class="u">video</span>...</p>
                </section>

                <section>
                    <h2>Exemples</h2>
                    <p>Le plus simple</p>
                    <pre><code data-trim contenteditable class="html">
&lt;video src="video.mp4"&gt;&lt;/video&gt;
                    </code></pre>
                </section>

                <section>
                    <p>Message de fallback pour les visiteurs dont le navigateur ne supporte pas la vidéo</p>
                    <pre><code data-trim contenteditable class="html">
&lt;video src="video.mp4"&gt;
    Your browser doesn't support video API
&lt;/video&gt;
                    </code></pre>
                </section>

                <section>
                    <h2>Attributs</h2>
                    <ul>
                        <li><span class="hl">src</span> Fichier source</li>
                        <li><span class="hl">autoplay</span> Lance la lecture dès que le fichier suffisamment chargé</li>
                        <li><span class="hl">loop</span> Recommence la lecture à la fin</li>
                        <li><span class="hl">preload</span> Choix du buffering (none / auto / metadata)</li>
                        <li><span class="hl">controls</span> Affiche un controlleur (propre au navigateur)</li>
                        <li><span class="hl">muted</span> Couper le son</li>
                    </ul>
                </section>

                <section>
                    <ul>
                        <li><span class="hl">width</span> Largeur du player</li>
                        <li><span class="hl">height</span> Hauteur du player</li>
                        <li><span class="hl">poster</span> Lien de l'image de presentation de la vidéo</li>
                    </ul>
                </section>

                <section>
                    <p>Il est inutile d'indiquer une valeurs aux attributs qui n'en nécessitent pas</p>
                    <pre><code data-trim contenteditable class="html">
&lt;video 
    src="video.mp4" 
    poster="image.jpg"
    autoplay
    loop
    controls
    muted
    width="800"
    height="600"
&gt;&lt;/video&gt;
                    </code></pre>
                </section>

                <section>
                    <h2>Formats</h2>
                    <p>Il est possible d'envoyer plusieurs formats et de laisser le navigateur choisir celui qu'il préfère</p>
                    <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Supported_media_formats#Browser_compatibility" target="_blank">Support des formats</a></p>
                    <pre><code data-trim contenteditable class="html">
&lt;video autoplay="autoplay" loop="loop" controls="controls" width="800"&gt;
    &lt;source src="video.mp4"  type="video/mp4"  /&gt;
    &lt;source src="video.webm" type="video/webm" /&gt;
    &lt;source src="video.ogv"  type="video/ogg"  /&gt;
    Your browser doesn't support video API
&lt;/video&gt;
                    </code></pre>
                </section>

                <section>
                    <ul>
                        <li><a target="blank" href="http://fr.wikipedia.org/wiki/Theora">OGG</a> (ogv) : Libre et gratuit (Firefox)</li>
                        <li><a target="_blank" href="http://fr.wikipedia.org/wiki/WebM" >WEBM</a> : Libre et gratuit (Chrome)</li>
                        <li><a target="_blank" href="http://fr.wikipedia.org/wiki/H.264">MP4</a> : Non-libre et payant</li>
                    </ul>
                </section>

                <section>
                    <h2>Convertir ses vidéos</h2>
                    <ul>
                        <li><a target="_blank" href="http://www.mirovideoconverter.com/">Miro Video Converter</a> Simple et efficace (Mac et Windows)</li>
                        <li><a target="_blank" href="https://handbrake.fr/">HandBrake</a> Plus complexe (Mac, Windows et Linux)</li>
                    </ul>
                </section>

                <section>
                    <h2>Compatibilité</h2>
                    <p>Can I Use : <a target="_blank" href="http://caniuse.com/#feat=video">http://caniuse.com/#feat=video</a></p>
                </section>

                <!-- CONTROLS JS -->
                <section>
                    <h2>Manipuler en Javascript</h2>
                </section>

                <section>
                    <p>Avant tout, il faut récupérer l'élément et le sauvegarder dans une variable.</p>
                    <pre><code contenteditable class="javascript">
var video = document.querySelector('video');
                    </code></pre>
                    <p>Une fois récupéré, on va pouvoir utiliser ses méthodes et modifier ses propriétés</p>
                </section>

                <section>
                    <p>En JS orienté objet, les objets fonctionnent avec des méthodes, des propriétés et des événements.</p>
                    <p>Prenons en exemple un humain.</p>
                    <ul>
                        <li>
                            <span class="u">Méthodes</span> : marche, cours, saute
                            <br>Ce sont des actions qu'on peut lui faire faire
                        </li>
                        <li>
                            <span class="u">Propriétés</span> : âge, hauteur, poids
                            <br>Ce sont des informations qu'on peut récupérer et modifier
                        </li>
                        <li>
                            <span class="u">Événements</span> : se réveil, s'endort, anniversaire
                            <br>Ce sont des événements qu'on peut écouter 
                        </li>
                    </ul>
                </section>

                <section>
                    <p>Les objets audio et video fonctionnent de la même manière</p>
                </section>

                <section>
                    <h2>Méthodes</h2>
                    <ul>
                        <li>play()</li>
                        <li>pause()</li>
                    </ul>
                    <pre><code data-trim contenteditable class="javascript">
video.play();
video.pause();
                    </code></pre>
                </section>

                <section>
                    <h2>Propriétés</h2>
                    <div style="width:60%;margin:0 auto;">
                        <ul style="float:left;">
                            <li>controls</li>
                            <li>loop</li>
                            <li>autoplay</li>
                            <li>volume</li>
                        </ul>
                        <ul style="float:right;">
                            <li>currentTime</li>
                            <li>duration</li>
                            <li>muted</li>
                            <li><a href="http://www.w3schools.com/tags/ref_av_dom.asp" target="_blank">...</a></li>
                        </ul>
                    </div>
                    <pre style="clear:both;"><code data-trim contenteditable class="javascript">
console.log(video.volume);
video.volume += 0.1;
                    </code></pre>
                </section>

                <section>
                    <h2>Événements</h2>
                    <div style="width:60%;margin:0 auto;">
                        <ul style="float:left;">
                            <li>play</li>
                            <li>pause</li>
                            <li>playing</li>
                            <li>seeking</li>
                        </ul>
                        <ul style="float:right;">
                            <li>canplay</li>
                            <li>canplaythrough</li>
                            <li>progress</li>
                            <li><a href="http://www.w3schools.com/tags/ref_av_dom.asp" target="_blank">...</a></li>
                        </ul>
                    </div>
                    <pre style="clear:both;"><code data-trim contenteditable class="javascript">
video.addEventListener('play',function(e)
{
    console.log('playing');
});
                    </code></pre>
                </section>

                <section>
                    <h2>Méthodes / Propriétés / Événements</h2>
                    <p>Liste complète : <a target="_blank" href="http://www.w3schools.com/tags/ref_av_dom.asp">http://www.w3schools.com/tags/ref_av_dom.asp</a></p>
                </section>

                <section>
                    <h2>Exemples</h2>
                    <p><small>Écouter l'événement "click" sur un bouton pour augmenter le volume sans dépasser la limite</small></p>

                    <pre style="clear:both;"><code data-trim contenteditable class="html">
&lt;video src="#"&gt;&lt;/video&gt;
&lt;button id="volume-up"&gt;+&lt;/button&gt;
                    </code></pre>
                    <pre style="clear:both;"><code data-trim contenteditable class="javascript">
// Récupérer les éléments
var video     = document.querySelector('video'),
    volume_up = document.querySelector('.volume-up');

// Écouter les clicks
volume_up.addEventListener( 'click', function()
{
    // Met à jour le volume
    if(video.volume + 0.1 &lt;= 1)
        video.volume += 0.1;
    else
        video.volume = 1;
} );
                    </code></pre>
                </section>

                <section>
                    <h2>Exemples</h2>
                    <p><small>Écouter l'événement "click" sur une div pour changer la position de la lecture<br>(CSS non inclus)</small></p>

                    <pre style="clear:both;"><code data-trim contenteditable class="html">
&lt;video src="#"&gt;&lt;/video&gt;
<div class="bar"></div>
                    </code></pre>
                    <pre style="clear:both;"><code data-trim contenteditable class="javascript">
// Récupérer les éléments
var video = document.querySelector('video'),
    bar   = document.querySelector('.bar');

// Écouter les clicks
bar.addEventListener( 'click', function( event )
{
    // Calculer le temps de la vidéo par rapport à la position du click sur la bar
    var ratio   = ( event.clientX - bar.offsetLeft ) / bar.offsetWidth,
        current = video.duration * ratio;

    // Met à jour la lecture de la vidéo
    video.currentTime = current;
} );
                    </code></pre>
                </section>

                <section>
                    <h2>Exemples</h2>
                    <p><small>Mettre à jour le curseur d'une barre en fonction de l'avancement dans la vidéo<br>(CSS non inclus)</small></p>

                    <pre style="clear:both;"><code data-trim contenteditable class="html">
&lt;video src="#"&gt;&lt;/video&gt;
<div class="bar">
    <div class="cursor"></div>
</div>
                    </code></pre>
                    <pre style="clear:both;"><code data-trim contenteditable class="javascript">
// Récupérer les éléments
var video  = document.querySelector('video'),
    bar    = document.querySelector('.bar'),
    cursor = document.querySelector('.cursor');

// Executer cette fonction toutes les 50ms
window.setInterval( function()
{
    // Calcul le pourcentage de vidéo déjà passé
    var ratio = video.currentTime / video.duration;
    
    cursor.style.transform = 'scaleX(' + ratio + ')';
}, 50 );
                    </code></pre>
                </section>
			</div>
		</div>

        <script src="../src/reveal.js/lib/js/head.min.js"></script>
        <script src="../src/reveal.js/js/reveal.js"></script>
        <script src="../src/custom/script.js"></script>
	</body>
</html>
